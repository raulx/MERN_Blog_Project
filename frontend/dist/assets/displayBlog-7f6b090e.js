import{r as c,v as G,w as P,x as D,y as H,j as e,z as Q,A as U,B as $,u as W,C as Z,D as J,L as K}from"./index-bb1fa0f4.js";import{h as L,j as O,f as X,d as Y}from"./index.esm-d80a0af3.js";import{f as V}from"./functions-8c014a9e.js";import{G as F}from"./iconBase-bb30e71b.js";import{I as R}from"./index.esm-073f710c.js";import{A as S}from"./avatar-6ff15a18.js";import{U as ee}from"./useMyContext-bdf5d29c.js";import"./theme-options-4949be72.js";function te(t){return F({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#8BC34A",points:"24,3 28.7,6.6 34.5,5.8 36.7,11.3 42.2,13.5 41.4,19.3 45,24 41.4,28.7 42.2,34.5 36.7,36.7 34.5,42.2 28.7,41.4 24,45 19.3,41.4 13.5,42.2 11.3,36.7 5.8,34.5 6.6,28.7 3,24 6.6,19.3 5.8,13.5 11.3,11.3 13.5,5.8 19.3,6.6"}},{tag:"polygon",attr:{fill:"#CCFF90",points:"34.6,14.6 21,28.2 15.4,22.6 12.6,25.4 21,33.8 37.4,17.4"}}]})(t)}function se(t){return F({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z"}},{tag:"line",attr:{x1:"18",x2:"12",y1:"9",y2:"15"}},{tag:"line",attr:{x1:"12",x2:"18",y1:"9",y2:"15"}}]})(t)}function ae(t){return F({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z"}}]})(t)}function le({commentData:t,userData:h,blogData:y,authorData:p,blogId:g,updateBlogComments:o}){const[_,i]=c.useState(!1),[l,m]=c.useState(!1),[f,j]=c.useState(!1),[b,v]=c.useState(""),[N,w]=c.useState(""),[s,n]=G(),[d,C]=P(),[A,I]=D(),[B,k]=H(),E=async a=>{i(!1);const x={blogId:g,commentId:a._id};try{const r=await s(x);o(r.data.updated.comments)}catch(r){console.log(r)}},M=a=>{v(a.comment),i(!0),m(!1)},z=async a=>{const x={commentId:a._id};try{const r=await B(x);o(r.data.updatedBlog.comments),j(!1)}catch(r){console.log(r)}},T=async(a,x)=>{a.preventDefault(),i(!1);const r={reply:N,blogId:g,commentId:x._id};try{const u=await A(r);o(u.data.newblog.comments),m(!1),j(!0),w("")}catch(u){console.log(u)}},q=async(a,x)=>{a.preventDefault();const r={blogId:g,commentId:x._id,newComment:b};try{const u=await d(r);o(u.data.data.comments),i(!1)}catch(u){console.log(u)}};return e.jsxs("div",{className:"flex gap-4 mb-8 py-4 border border-gray-400 relative rounded-2xl",children:[e.jsx("div",{className:"absolute top-0 left-0 -translate-x-1/2 -translate-y-1/2",children:e.jsx(S,{src:t.profile_pic,size:"4",radius:"full",className:"border border-gray-400"})}),e.jsxs("div",{className:"mx-8 w-full",children:[e.jsxs("div",{className:"flex relative justify-start items-center",children:[e.jsx("h1",{className:"text-xl font-bold text-blue-600",children:t.creator_name}),e.jsx("p",{className:"ml-4",children:V(t.created_at)}),h._id===y.data.created_by.id?e.jsx("div",{className:"absolute right-10",children:t.replies.length===0?e.jsx(e.Fragment,{children:e.jsx("button",{className:"bg-transparent border-none text-blue-700",onClick:()=>{i(!1),m(!l)},children:"Reply"})}):e.jsxs("div",{className:"flex gap-2 items-center font-extrabold text-green-400",children:["Replied ",e.jsx(te,{})]})}):null]}),e.jsx("hr",{className:"my-2 border-t-2 "}),e.jsxs("div",{className:"flex flex-col",children:[_?e.jsxs("form",{onSubmit:a=>{q(a,t)},children:[e.jsx("textarea",{value:b,className:"w-full p-2 h-32 border-2 rounded multiline mb-6",required:!0,onChange:a=>{v(a.target.value)}}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{className:"py-2 px-4 bg-blue-500 text-white rounded-lg",type:"submit",children:C.isLoading?e.jsx(L,{className:"animate-spin text-2xl"}):e.jsx(e.Fragment,{children:"Save"})}),e.jsx("button",{className:"py-2 px-4 bg-blue-500 text-white rounded-lg",onClick:()=>{i(!1)},children:"exit"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:t.comment}),h._id===t.creator_id||h._id===y.data.created_by.id?e.jsxs("div",{className:"self-end mr-10 mt-2 flex gap-5",children:[t.replies.length>0?e.jsx("button",{className:"text-blue-700",onClick:()=>{j(!f)},children:f?e.jsx(e.Fragment,{children:"Hide Reply"}):e.jsxs(e.Fragment,{children:[t.replies.length," reply"]})}):null,e.jsx("button",{className:"p-4 bg-blue-500 text-white rounded-lg",onClick:()=>{M(t)},children:e.jsx(O,{})}),e.jsx("button",{className:"p-4 bg-blue-500 text-white rounded-lg",onClick:()=>{E(t)},children:n.isLoading?e.jsx(R,{className:"animate-spin text-2xl"}):e.jsx(X,{})})]}):null]}),e.jsx("div",{className:"flex items-center",children:f?e.jsx(e.Fragment,{children:t.replies.map(a=>e.jsxs("div",{className:"ml-36 mt-10 border-2 rounded-xl flex  p-4 bg-gray-200 relative w-2/3",children:[e.jsx("div",{className:"absolute left-0 top-0 -translate-x-1/2 -translate-y-1/2 rounded-full border-2 bg-gray-100",children:e.jsx(S,{src:p.data.profile_pic})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"font-bold text-xl",children:p.data.name}),e.jsx("span",{className:"bg-green-400 text-white text-center rounded-3xl w-16",children:"Author"}),e.jsx("p",{className:"mb-2",children:a.reply})]}),h._id===y.data.created_by.id?e.jsx("div",{className:"font-extrabold text-xl absolute right-4 top-2 flex gap-4",children:k.isLoading?e.jsx(R,{className:"animate-spin"}):e.jsx(se,{className:"cursor-pointer",onClick:()=>z(t)})}):null]},a._id))}):null})]}),l?e.jsxs("form",{className:"flex ml-24",onSubmit:a=>{T(a,t)},children:[e.jsx(S,{src:p.data.profile_pic,className:"mr-4 border-2 rounded-lg"}),e.jsx("input",{value:N,className:"w-4/5",required:!0,onChange:a=>{w(a.target.value)}}),e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-500 text-white",children:I.isLoading?e.jsx(R,{className:"animate-spin text-2xl"}):e.jsx(ae,{className:"text-2xl"})})]}):null]})]})}function ue(){const[t]=Q(),{phoneNav:h,setPhoneNav:y}=ee(),[p,g]=c.useState(""),o=t.get("blogId"),_=t.get("authorId"),{data:i}=U(_),[l,m]=c.useState({isLoading:!0,data:null}),[f]=$(),{userData:j}=W(s=>s.user),[b,v]=Z();c.useEffect(()=>{(async()=>{try{const n=await f(o);n.status==="fulfilled"&&m(d=>({...d,isLoading:!1,data:n.data.data}))}catch(n){console.log(n)}})()},[o,f]);const N=async s=>{s.preventDefault();const n={blogId:o,userId:j._id,comment:p};try{const d=await b(n);d.data&&m(C=>({...C,data:{...C.data,comments:d.data.blog.comments}}))}catch(d){console.error(d)}g("")},w=s=>{m(n=>({...n,data:{...n.data,comments:s}}))};return e.jsxs("div",{className:"h-screen overflow-y-scroll",children:[e.jsx("div",{className:`col-span-1  text-lg flex md:hidden absolute z-20 top-24 left-0 w-full h-full  row-span-6 gap-2 sidebar rounded shadow-sm flex-col md:translate-x-0 items-center border bg-white md:py-6 transition-all duration-200 md:px-4 overflow-y-scroll ${h?"translate-x-0":"-translate-x-full"}`,children:J.map(s=>e.jsx(K,{className:`w-full hover:bg-green-400 hover:text-white uppercase py-4 rounded transition-all duration-200 text-center  ${location.pathname===s.url?"bg-green-500 text-white":null}`,to:s.url,onClick:()=>y(!1),children:s.type},s.type))}),e.jsx("div",{className:"w-11/12 mx-auto",children:e.jsx(e.Fragment,{children:l.data&&i?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("img",{className:"rounded-lg max-h-96",src:l.data.image.remote_url}),e.jsxs("div",{className:"grow p-4",children:[e.jsx("h1",{className:"text-5xl uppercase font-extrabold mt-10",children:l.data.title}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex gap-4  items-center ml-4",children:[e.jsx(Y,{}),l.data.views]}),e.jsx("div",{className:"mt-4",children:l.data.date})]}),e.jsx("div",{className:"flex gap-4 items-center mt-4",children:e.jsx("p",{className:"font-bold text-lg",children:i.data.name})})]})]}),e.jsx("div",{className:"text-lg my-10",children:l.data.content}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl capitalize font-bold border-b-2 mb-16",children:[l.data.comments.length," Comments"]}),l.data.comments.slice().reverse().map(s=>e.jsx(le,{commentData:s,userData:j,blogData:l,authorData:i,updateBlogComments:w,blogId:o},s._id)),e.jsxs("form",{onSubmit:s=>N(s),children:[e.jsx("div",{className:"my-4",children:e.jsx("input",{type:"text",required:!0,value:p,onChange:s=>{g(s.target.value)},className:"border-2 h-12 w-2/3 outline-none select-none px-4"})}),e.jsx("div",{className:"my-6",children:e.jsx("button",{type:"submit",className:"py-2 px-4 bg-blue-500 text-white",children:e.jsx(e.Fragment,{children:v.isLoading?e.jsx(L,{className:"animate-spin text-2xl"}):e.jsx(e.Fragment,{children:"Add Reply"})})})})]})]})]}):e.jsx("div",{className:"w-full h-[36rem] flex justify-center items-center",children:e.jsx(L,{className:"animate-spin text-5xl"})})})})]})}export{ue as default};
